<!doctype html>  
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>Ciacco Davide</title>
		<meta name="description" content="Realized using css3, html5, JS and PHP">
		<meta name="author" content="Davide Ciacco">
		<meta name="viewport" content="width=800, user-scalable=yes">
		<link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
		<link rel="stylesheet" href="css/crypt.css">
		<script type='text/javascript' src='http://code.jquery.com/jquery-1.6.js'></script>
		<link rel="stylesheet" href="fonts/base64_quicksandfonts.css" type="text/css" charset="utf-8">
	</head>
	
	<body>
		<header>
			<h1>Crypt 2.0</h1>
		</header>
		<contents>
		<post>
			<form>
				<INPUT TYPE="text" NAME="inputbox" VALUE="" placeholder="input"><P>
				<INPUT TYPE="text" NAME="keylockbox" VALUE="" placeholder="keylock"><P>
				<INPUT TYPE="button" NAME="button" Value="Crypt" onClick="crypt(this.form)"><P>
				<span id="0"></span><br>
				<h2></h2><span id="3"></span><br>
				<h2></h2><span id="2"></span><br>
				
			</form>
		</post>	
			
		<post>
			<form>
				<span id="crypted"></span><br>
				<h2></h2>
				<INPUT TYPE="text" NAME="crypted" VALUE="" placeholder="crypted text"><P>
				<INPUT TYPE="text" NAME="unlockbox" VALUE="" placeholder="unlock key"><P>
				<INPUT TYPE="button" NAME="button" Value="deCrypt" onClick="decrypt(this.form)"><P>
				<h2></h2>
				<span id="decrypted"></span><br>
			</form>
		</post>	
		
		
		</contents>
		<footer>
			<foot>Created by <a>Davide Ciacco</a></foot>
		</footer>
		
		<div class="sharing">
			<a href="http://twitter.com/share" class="twitter-share-button" data-text="Work in progress #CiaccoDavide" data-url="http://ciaccodavi.de" data-count="small"></a>
		</div>
		<script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
		
		<script type="text/javascript">
		
		function crypt(form) {
			/*------DIPS------------------------------------------------------------------------*/
			var chars=new Array();z=0;for(i=97;i<123;i++){chars[z]=String.fromCharCode(i);z++;}for(i=65;i<91;i++){chars[z]=String.fromCharCode(i);z++;}for(i=48;i<58;i++){chars[z]=String.fromCharCode(i);z++;}chars[z]=String.fromCharCode(33);z++;chars[z]=String.fromCharCode(39);z++;chars[z]=String.fromCharCode(44);z++;chars[z]=String.fromCharCode(46);z++;chars[z]=String.fromCharCode(58);z++;chars[z]=String.fromCharCode(63);z++;chars[z]=String.fromCharCode(32);z++;var disposti=new Array();k=0;for(x=0;x<69;x++){for(y=0;y<69;y++){disposti[k]=chars[x]+chars[y];k++;}}for(i=97;i<123;i++){disposti[k]=String.fromCharCode(i);k++;}for(i=65;i<91;i++){disposti[k]=String.fromCharCode(i);k++;}for(i=48;i<58;i++){disposti[k]=String.fromCharCode(i);k++;}disposti[k]=String.fromCharCode(33);k++;disposti[k]=String.fromCharCode(39);k++;disposti[k]=String.fromCharCode(44);k++;disposti[k]=String.fromCharCode(46);k++;disposti[k]=String.fromCharCode(58);k++;disposti[k]=String.fromCharCode(63);k++;disposti[k]=String.fromCharCode(32);k++;
			/*----------------------------------------------------------------------------------*/
			
			
			input = form.inputbox.value;
			keylock = form.keylockbox.value;
			
			keyarray = keylock.split("");
			for(i = 0; i < keyarray.length; i++){
				keyarray[i]=parseInt((keyarray[i].charCodeAt(0)+i*69)/10);//migliorabile
			}
			
			var respect = new Array();
			c=0;
			if(input.length*10>disposti.length*10){
				lim=input.length*10;
			}
			else{
				lim=disposti.length*10;
			}
			for(i = 19968; i <= 19968+lim; i++){
				respect[c] = String.fromCharCode(i);
				c++;
			}
			/*input split*/
			var splitted = new Array();
			s = 0;
			for(i = 0; i <= input.length; i){
				splitted[s] = input.substring(i++, ++i);
				s++;
			}
			
			/*crypting*/
			var crypted = new String();
			cry=0;
			kr=0;
			for(q = 0; q < splitted.length+1; q++){
				for(w = 0; w < disposti.length; w++){
					if(splitted[q]==disposti[w]){
						crypted += String.fromCharCode(respect[w].charCodeAt(0)+keyarray[kr]);
						cry++;
						if(kr<keyarray.length-1){
							kr++;
						}
						else{
							kr=0;
						}
					}
				}
			}
			document.getElementById('0').innerHTML = keyarray;
			document.getElementById('3').innerHTML = splitted;
			document.getElementById('2').innerHTML = crypted;
		}
		
		
		
		function decrypt(form) {

			document.getElementById('crypted').innerHTML = "Crypted: ";
			document.getElementById('decrypted').innerHTML = "Decrypted: ";
			
			crptd = form.crypted.value;
			document.getElementById('crypted').innerHTML += crptd;
			
			unlocker = form.unlockbox.value;
			unlockkeyarray = unlocker.split("");
			var ukn = new Number();
			for(i = 0; i < unlockkeyarray.length; i++){
				ukn += ((i+1)*keyarray[i].charCodeAt(0))-keyarray[i].charCodeAt(0);
					if(ukn > 1000)
						ukn = keyarray[i].charCodeAt(0);
			}
			
			var arraycrypted = crptd.split("");
			var arraydecrypted = new Array();
			for(i = 0; i < arraycrypted.length; i++){
				arraydecrypted[i] = String.fromCharCode(arraycrypted[i].charCodeAt(0)/ukn);
				document.getElementById('decrypted').innerHTML += arraydecrypted[i];
			}
			
		}

		</script>
		
	</body>
</html>